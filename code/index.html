<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript" src='js/draw_graph.js'> </script>
        <script type="text/javascript" src='js/runge-kutta-method.js'> </script>
        <link type="text/css" rel="stylesheet" href="style.css">
        <title>Differential equation solver</title><meta charset="utf-8"/>
    </head>
    <body>
            <header class="mainDetails ">
                <div class="mainDetails__photo">
                    <img src="../assets/Grafikas.png" alt="Logo">
                </div>
                <div class="mainDetails__info">
                    <h1>Diferencialinių lygčių sprendimo sistema</h1>
                    <h2>Sukūrė: Gabrielė Anužytė, Dominika Barilovič</h2>
                </div>
                <div class="mainDetails__contact">
                    <a href="mailto:gabriele.anuzyte@mif.stud.vu.lt">e: gabriele.anuzyte@mif.stud.vu.lt</a> <br>
                    <a href="mailto:dominika.barilovic@mif.stud.vu.lt">e: dominika.barilovic@mif.stud.vu.lt</a> <br>
                    <a href="http://vu.lt">w: www.vu.lt</a> <br>
                </div>    
                <div class="clear"></div>
            </header>
        <div>

            <div id=canvas class=canvas>
                <canvas id="myCanvas" width="400" height="400" style="border:1px solid #000000;">
                    Your browser does not support the HTML5 canvas tag.
                </canvas>
            </div>

            <div class="Objects">
                <div id=function>
                    <div id=f>
                        Funkcija f(y,t):
                        <input type="text" id="func0" value="y">
                    </div>         
                    
                    <div id=sk>
                        Kiek funkcijų pridėti?
                        <input type="number" id="func_counter" value="2">
                    </div> 

                    
                </div>
            
                <div id=inputs>
                    <div id=interv_begins class=input>
                        Intervalo pradžia: 
                        <input type="number" id="int_begins" value="0"> 
                    </div> 
                
                    <div id=interv_ends class=input> 
                        Intervalo pabaiga:
                        <input type="number" id="int_ends" value="1"> 
                    </div>
                
                    <div id=y0 class=input>
                        y0:               
                        <input type="number" id="y0_inp" value="1"> 
                    </div> 
                
                    <div id=N class=input>
                        N:                
                        <input type="number" id="n_inp" value="100"> 
                    </div>
                
                    
                </div>
                
            </div>

            <div class="visimygtukai">
            <div id=button class=input>
                    <button id=add_func>Add another function</button>
            </div>
            <div id=dumygtukai class=input>
                   <button id=submit>Submit</button>
                   <button id=delete>Išvalyti grafiką</button>
                   
               </div>
            </div>

        </div>

            <script>
                //Sukuriamas laukas grafikui
                var c = document.getElementById("myCanvas");
                var ctx = c.getContext("2d");
                draw(ctx);
                
                //Nupiešiama kreivė pagal įvestus parametrus
                document.getElementById("submit").addEventListener("click", function(event) {
                    var funct_count = parseInt(document.getElementById("func_counter").value);

                    
                    var int_begin = parseInt(document.getElementById("int_begins").value);
                    var int_end = parseInt(document.getElementById("int_ends").value);
                    var y0 = parseInt(document.getElementById("y0_inp").value);
                    var N = parseInt(document.getElementById("n_inp").value);

                    for(i=0; i<funct_count; i++){
                        var function_name = "func"+i;
                        console.log(function_name);
                        var funct = document.getElementById(function_name).value;
                        var [yy, tt] = solution(y0, int_begin, int_end, N, funct);
                        var [yp,tp] = normalization(yy, tt, int_begin, int_end, c.height, c.width);
                        
                        //Piešiamia kreivė
                        ctx.moveTo(tp[0],yp[0]);
                        for(i=1; i<N; i++){
                            ctx.lineTo(tp[i],yp[i]); 
                        }
                        ctx.strokeStyle = getRandomColor();
                        ctx.stroke();   
                    }
                });

                //Prideda papildomą funkcijos input lauką
                document.getElementById("add_func").addEventListener("click", function(event){
                    var d = document.getElementById("funkcijos");

                    var funct_count = parseInt(document.getElementById("func_counter").value);
                    
                    for(i=1; i<funct_count; i++){
                        var function_name = "func"+i;
                        var function_html = `<div id=${function_name} class=function_input>Funkcija f(y,t): <input type='text' value='y'></div>`;
                        console.log(function_html);
                        console.log(typeof function_html);
                        d.innerHTML += `<div id=${function_name} class=function_input>Funkcija f(y,t): <input type='text' value='y'></div>`;
                    }
                });
    
                //Išvalo grafiką
                document.getElementById("delete").addEventListener("click", function(event){
                ctx.clearRect(0,0, c.width, c.height )
                ctx.beginPath();
                draw(ctx);
            });

                
        </script>
    </div>
    </body>
</html>