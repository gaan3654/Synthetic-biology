@@ -0,0 +1,162 @@
<!-- Styles -->
<style>
  #chartdiv {
    width: 100%;
    height: 500px;
    max-width: 100%;
  }
</style>

<!-- Resources -->
<script src="https://www.amcharts.com/lib/4/core.js"></script>
<script src="https://www.amcharts.com/lib/4/charts.js"></script>
<script src="https://www.amcharts.com/lib/4/themes/animated.js"></script>

<!-- Chart code -->
<script>
  am4core.ready(function () {
    // Themes begin
    am4core.useTheme(am4themes_animated);
    // Themes end

    // Create chart instance
    let chart = am4core.create("chartdiv", am4charts.XYChart);

    // Create axes
    let xAxis = chart.xAxes.push(new am4charts.ValueAxis());
    xAxis.title.text = "Time";
    let yAxis = chart.yAxes.push(new am4charts.ValueAxis());
    yAxis.title.text = "Concentration";

    let seriesList = [];
    for (let i = 0; i < 10; i++) {
      seriesList.push(createSeries("value" + i, "MedÅ¾iagos iteracija #" + i));
    }

    // Create series
    function createSeries(s, name) {
      let series = chart.series.push(new am4charts.LineSeries());
      series.dataFields.valueY = s;
      series.dataFields.valueX = "time";
      series.name = name;
      series.strokeOpacity = 0.5;

      addFeatures(series);

      let data = [];
      let value = Math.round(Math.random() * 100) + 100;
      for (let i = 1; i < 100; i++) {
        value += Math.round(
          (Math.random() < 0.5 ? 1 : -1) * Math.random() * 30 + i / 5
        );
        let dataItem = { time: i };
        dataItem[s] = value;
        data.push(dataItem);
      }

      series.data = data;

      return series;
    }

    function addFeatures(series) {
      let segment = series.segments.template;
      segment.interactionsEnabled = true;

      let hoverState = segment.states.create("hover");
      hoverState.properties.strokeWidth = 3;
      hoverState.properties.strokeOpacity = 1;

      let dimmed = segment.states.create("dimmed");
      dimmed.properties.stroke = am4core.color("#dadada");

      segment.events.on("over", function (event) {
        processOver(event.target.parent.parent.parent);
      });

      segment.events.on("out", function (event) {
        processOut(event.target.parent.parent.parent);
      });
    }

    function meanOfSeries(seriesList, meanSeries) {
      let data = [];
      for (let i = 0; i < 99; i++) {
        let value = 0;
        for (let s = 0; s < seriesList.length; s++) {
          value += seriesList[s].data[i]["value" + s];
        }

        let dataItem = { time: i };
        dataItem["valueMean"] = value / seriesList.length;
        data.push(dataItem);
      }
      meanSeries.data = data;
    }

    let meanSeries = chart.series.push(new am4charts.LineSeries());
    meanSeries.dataFields.valueY = "valueMean";
    meanSeries.dataFields.valueX = "time";
    meanSeries.name = "Mean";
    addFeatures(meanSeries);
    meanSeries.strokeWidth = 2;
    meanOfSeries(seriesList, meanSeries);

    meanSeries.tooltipText =
      "Time: [bold]{valueX}[/]\nConcentration: [bold]{categoryY}[/]";
    meanSeries.tooltip.pointerOrientation = "vertical";
    meanSeries.tooltip.background.cornerRadius = 20;
    meanSeries.tooltip.background.fillOpacity = 0.5;
    meanSeries.tooltip.label.padding(12, 12, 12, 12);

    // Add scrollbar
    chart.scrollbarX = new am4charts.XYChartScrollbar();
    // add the mean of all series
    chart.scrollbarX.series.push(meanSeries);

    chart.cursor = new am4charts.XYCursor();
    chart.cursor.yAxis = yAxis;
    chart.cursor.snapToSeries = meanSeries;

    chart.legend = new am4charts.Legend();
    chart.legend.position = "right";
    chart.legend.scrollable = true;
    chart.legend.itemContainers.template.events.on("over", function (event) {
      processOver(event.target.dataItem.dataContext);
    });

    chart.legend.itemContainers.template.events.on("out", function (event) {
      processOut(event.target.dataItem.dataContext);
    });

    function processOver(hoveredSeries) {
      hoveredSeries.toFront();

      hoveredSeries.segments.each(function (segment) {
        segment.setState("hover");
      });

      chart.series.each(function (series) {
        if (series != hoveredSeries) {
          series.segments.each(function (segment) {
            segment.setState("dimmed");
          });
          series.bulletsContainer.setState("dimmed");
        }
      });
    }

    function processOut(hoveredSeries) {
      chart.series.each(function (series) {
        series.segments.each(function (segment) {
          segment.setState("default");
        });
        series.bulletsContainer.setState("default");
      });
    }
  }); // end am4core.ready()
</script>

<!-- HTML -->
<div id="chartdiv"></div>
